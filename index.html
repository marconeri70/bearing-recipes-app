<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover"
  />
  <title>Ricette Lavorazione Cuscinetti</title>

  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF per export PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <!-- JSZip per import/export ZIP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" defer></script>

  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0b4f9c" />
</head>
<body>
  <div class="app-root">
    <!-- HEADER -->
    <header class="app-header">
      <div class="app-header-content">
        <h1>Ricette Lavorazione Cuscinetti</h1>
        <p>Gestione lavorazioni: IR, OR, sfere, gabbia, grasso, schermi, gioco radiale</p>
      </div>
    </header>

    <main class="app-main">
      <!-- COLONNA SINISTRA: LISTA LAVORAZIONI -->
      <section class="panel panel-left">
        <div class="panel-header">
          <h2>Lavorazioni</h2>
          <span id="conteggio-lavorazioni" class="badge-count">0 ricette salvate</span>
        </div>

        <div class="toolbar">
          <button id="btn-import" class="btn btn-secondary">
            üì• Importa CSV
          </button>
          <button id="btn-export-csv" class="btn btn-secondary">
            üì§ Esporta CSV
          </button>
        </div>

        <div class="toolbar">
          <button id="btn-export-pdf" class="btn btn-secondary">
            üìÑ Esporta PDF
          </button>
        </div>

        <div class="toolbar">
          <button id="btn-import-zip" class="btn btn-secondary">
            üóÇÔ∏è Importa ZIP
          </button>
          <button id="btn-export-zip" class="btn btn-secondary">
            üß∑ Esporta ZIP
          </button>
        </div>

        <!-- input nascosti per import -->
        <input id="file-import" type="file" accept=".csv,text/csv" style="display:none" />
        <input id="file-import-zip" type="file" accept=".zip,application/zip" style="display:none" />

        <div id="lista-lavorazioni" class="lista-lavorazioni">
          <!-- righe generate da JS -->
        </div>

        <div class="panel-footer">
          <button id="btn-nuova" class="btn btn-primary btn-big">
            ‚ûï Nuova
          </button>
          <p class="note-storage">
            Dati e immagini salvati solo sul dispositivo (localStorage).
          </p>
        </div>
      </section>

      <!-- COLONNA DESTRA: DETTAGLIO LAVORAZIONE -->
      <section class="panel panel-right">
        <div id="card-form" class="card card-form is-hidden">
          <div class="card-header">
            <div>
              <h2>Dettaglio lavorazione</h2>
              <p id="stato-modifica" class="card-subtitle">Nuova lavorazione</p>
            </div>
            <button id="btn-scheda-tecnica" class="btn btn-outline" disabled>
              üìò Scheda tecnica
            </button>
          </div>

          <form id="form-lavorazione" class="form-grid">
            <!-- Codice -->
            <div class="form-group full">
              <label for="codice">Codice lavorazione *</label>
              <input id="codice" type="text" class="input" placeholder="Es. BB1-0654 A" required />
            </div>

            <!-- IR / Diametro foro IR -->
            <div class="form-group">
              <label for="irTipo">IR - Tipo</label>
              <input id="irTipo" type="text" class="input" placeholder="Es. BB1-0654" />
            </div>

            <div class="form-group">
              <label for="irDiametro">Diametro foro IR (mm)</label>
              <input id="irDiametro" type="number" step="0.001" class="input" placeholder="Es. 25" />
            </div>

            <!-- OR -->
            <div class="form-group">
              <label for="orTipo">OR - Tipo</label>
              <input id="orTipo" type="text" class="input" placeholder="Es. BB1-0654" />
            </div>

            <!-- Sfere -->
            <div class="form-group">
              <label for="diametroSfera">Sfera - Diametro (mm)</label>
              <input id="diametroSfera" type="number" step="0.001" class="input" placeholder="Es. 6,747" />
            </div>

            <div class="form-group">
              <label for="numeroSfere">Sfera - Numero sfere (n)</label>
              <input id="numeroSfere" type="number" step="1" class="input" placeholder="Es. 9" />
            </div>

            <!-- Gabbia / Grasso / Schermo -->
            <div class="form-group">
              <label for="gabbiaTipo">Gabbia - Tipo</label>
              <input id="gabbiaTipo" type="text" class="input" placeholder="Es. CJ-6205 A TN91" />
            </div>

            <div class="form-group">
              <label for="grassoTipo">Grasso - Tipo</label>
              <input id="grassoTipo" type="text" class="input" placeholder="Es. GXN" />
            </div>

            <div class="form-group">
              <label for="schermoTipo">Schermo / Tenuta</label>
              <input id="schermoTipo" type="text" class="input" placeholder="Es. SG-BB1-2557 E" />
            </div>

            <!-- Peso -->
            <div class="form-group">
              <label for="pesoMin">Peso minimo (g)</label>
              <input id="pesoMin" type="number" step="0.01" class="input" />
            </div>

            <div class="form-group">
              <label for="pesoMax">Peso massimo (g)</label>
              <input id="pesoMax" type="number" step="0.01" class="input" />
            </div>

            <!-- Gioco radiale -->
            <div class="form-group">
              <label for="classeGioco">Gioco radiale - Classe</label>
              <select id="classeGioco" class="input">
                <option value="">Seleziona classe‚Ä¶</option>
              </select>
            </div>

            <div class="form-group">
              <label for="giocoMin">Gioco min (¬µm)</label>
              <input id="giocoMin" type="number" step="0.1" class="input" />
            </div>

            <div class="form-group">
              <label for="giocoMax">Gioco max (¬µm)</label>
              <input id="giocoMax" type="number" step="0.1" class="input" />
            </div>

            <!-- Disegno tecnico -->
            <div class="form-group full">
              <label>Carica disegno tecnico</label>
              <button type="button" id="btn-file-galleria" class="btn btn-light full">
                üìÅ Scegli dalla galleria
              </button>
              <button type="button" id="btn-file-camera" class="btn btn-light full">
                üì∑ Scatta foto
              </button>
              <input id="file-galleria" type="file" accept="image/*" style="display:none" />
              <input
                id="file-camera"
                type="file"
                accept="image/*"
                capture="environment"
                style="display:none"
              />
            </div>

            <div class="form-group full">
              <label for="disegnoUrl">URL immagine (opzionale)</label>
              <input
                id="disegnoUrl"
                type="url"
                class="input"
                placeholder="https://‚Ä¶"
              />
            </div>

            <!-- Preview disegno -->
            <div class="form-group full">
              <label>Disegno tecnico (preview)</label>
              <div class="drawing-preview">
                <img id="drawing-image" alt="Disegno tecnico" />
                <div id="drawing-placeholder" class="drawing-placeholder">
                  Nessuna immagine caricata.
                </div>
              </div>
            </div>

            <!-- Pulsanti -->
            <div class="form-actions full">
              <button type="submit" class="btn btn-primary">
                üíæ Salva
              </button>
              <button type="button" id="btn-reset" class="btn btn-secondary">
                üßπ Svuota
              </button>
              <button type="button" id="btn-elimina" class="btn btn-danger" disabled>
                üóëÔ∏è Elimina
              </button>
            </div>
          </form>
        </div>
      </section>
    </main>
  </div>

  <!-- MODALE SCHEDA TECNICA -->
  <div id="scheda-modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content" id="scheda-print-area">
      <div class="modal-header">
        <div>
          <h3 id="scheda-codice">Codice</h3>
          <p id="scheda-sub" class="modal-subtitle"></p>
        </div>
        <div class="modal-header-actions">
          <button id="scheda-print" class="btn btn-outline btn-sm">üñ®Ô∏è Stampa scheda</button>
          <button id="scheda-close" class="btn btn-icon">‚úñ</button>
        </div>
      </div>

      <div class="modal-body">
        <!-- Disegno + dati: per la stampa la disposizione viene gestita dal CSS -->
        <div class="scheda-drawing">
          <div class="drawing-preview large">
            <img id="scheda-drawing-image" alt="Disegno tecnico" />
            <div id="scheda-drawing-placeholder" class="drawing-placeholder">
              Nessuna immagine disponibile.
            </div>
          </div>
        </div>

        <div class="scheda-grid">
          <div class="scheda-section-title">Dati principali</div>

          <div class="scheda-field">
            <span class="scheda-label">IR - Tipo</span>
            <span id="scheda-ir" class="scheda-value">-</span>
          </div>
          <div class="scheda-field">
            <span class="scheda-label">OR - Tipo</span>
            <span id="scheda-or" class="scheda-value">-</span>
          </div>
          <div class="scheda-field">
            <span class="scheda-label">Diametro foro IR</span>
            <span id="scheda-ir-diametro" class="scheda-value">-</span>
          </div>

          <div class="scheda-section-title">Rotolamento</div>

          <div class="scheda-field">
            <span class="scheda-label">Sfere</span>
            <span id="scheda-sfere" class="scheda-value">-</span>
          </div>
          <div class="scheda-field">
            <span class="scheda-label">Gabbia</span>
            <span id="scheda-gabbia" class="scheda-value">-</span>
          </div>

          <div class="scheda-section-title">Lubrificazione & schermatura</div>

          <div class="scheda-field">
            <span class="scheda-label">Grasso</span>
            <span id="scheda-grasso" class="scheda-value">-</span>
          </div>
          <div class="scheda-field">
            <span class="scheda-label">Schermo / Tenuta</span>
            <span id="scheda-schermo" class="scheda-value">-</span>
          </div>

          <div class="scheda-section-title">Peso & gioco</div>

          <div class="scheda-field">
            <span class="scheda-label">Peso</span>
            <span id="scheda-peso" class="scheda-value">-</span>
          </div>
          <div class="scheda-field">
            <span class="scheda-label">Gioco radiale</span>
            <span id="scheda-gioco" class="scheda-value">-</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js" defer></script>
</body>
</html>
