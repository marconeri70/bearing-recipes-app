<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Ricette Lavorazione Cuscinetti</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png" />
  <link rel="apple-touch-icon" href="icon-192.png" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="app-header">
    <h1>Ricette Lavorazione Cuscinetti</h1>
    <p>Gestione lavorazioni: IR, OR, sfere, gabbia, grasso, schermi, gioco radiale</p>
  </header>

  <main class="app-container">

    <!-- ====================== -->
    <!-- LISTA LAVORAZIONI (CRUSCOTTO) -->
    <!-- ====================== -->
    <section class="card card-list">

      <div class="card-header">
        <div>
          <h2>Lavorazioni</h2>
          <span id="conteggio-lavorazioni" class="counter-label"></span>
        </div>
        <button id="btn-nuova" type="button" class="btn btn-primary">â• Nuova</button>
      </div>

      <div class="toolbar">
        <!-- CSV -->
        <button id="btn-import" class="btn btn-secondary btn-sm">ğŸ“¥ Importa CSV</button>
        <input type="file" id="file-import" accept=".csv" style="display:none">

        <button id="btn-export-csv" class="btn btn-secondary btn-sm">ğŸ“¤ Esporta CSV</button>
        <button id="btn-export-pdf" class="btn btn-secondary btn-sm">ğŸ“„ Esporta PDF</button>

        <!-- ZIP -->
        <button id="btn-import-zip" class="btn btn-secondary btn-sm">ğŸ“¦ Importa ZIP</button>
        <input type="file" id="file-import-zip" accept=".zip" style="display:none">

        <button id="btn-export-zip" class="btn btn-secondary btn-sm">ğŸ“¦ Esporta ZIP</button>
      </div>

      <div id="lista-lavorazioni" class="lista-lavorazioni"></div>

      <div class="card-footer">
        <small>Dati e immagini salvati solo sul dispositivo (localStorage).</small>
      </div>

    </section>

    <!-- ====================== -->
    <!-- DETTAGLIO LAVORAZIONE (FORM, NASCOSTO DI DEFAULT) -->
    <!-- ====================== -->
    <section id="card-form" class="card card-form is-hidden">

      <div class="card-header">
        <div>
          <h2>Dettaglio lavorazione</h2>
          <span id="stato-modifica" class="stato-modifica"></span>
        </div>

        <button id="btn-scheda-tecnica" class="btn btn-secondary btn-sm" disabled>
          ğŸ“˜ Scheda tecnica
        </button>
      </div>

      <!-- FORM -->
      <form id="form-lavorazione" class="form-grid">

        <div class="form-group full-width">
          <label for="codice">Codice lavorazione *</label>
          <input id="codice" type="text" required placeholder="Es. BB1-0654 A">
        </div>

        <div class="form-group">
          <label for="irTipo">IR - Tipo</label>
          <input id="irTipo" type="text" placeholder="Es. BB1-0654">
        </div>

        <div class="form-group">
          <label for="irDiametro">Diametro foro IR (mm)</label>
          <input id="irDiametro" type="number" step="0.01" placeholder="Es. 25">
        </div>

        <div class="form-group">
          <label for="orTipo">OR - Tipo</label>
          <input id="orTipo" type="text" placeholder="Es. BB1-0654">
        </div>

        <div class="form-group">
          <label for="diametroSfera">Sfera - Diametro (mm)</label>
          <input id="diametroSfera" type="number" step="0.001" placeholder="Es. 3.968">
        </div>

        <div class="form-group">
          <label for="numeroSfere">Sfera - Numero sfere</label>
          <input id="numeroSfere" type="number" placeholder="Es. 9">
        </div>

        <div class="form-group">
          <label for="gabbiaTipo">Gabbia - Tipo</label>
          <input id="gabbiaTipo" type="text" placeholder="Es. CJ-6205 A-LS2P">
        </div>

        <div class="form-group">
          <label for="grassoTipo">Grasso - Tipo</label>
          <input id="grassoTipo" type="text" placeholder="Es. GXN">
        </div>

        <div class="form-group full-width">
          <label for="schermoTipo">Schermo / Tenuta</label>
          <input id="schermoTipo" type="text" placeholder="Es. 2RS1, LS2P, ecc.">
        </div>

        <div class="form-group">
          <label for="pesoMin">Peso minimo (g)</label>
          <input id="pesoMin" type="number" step="0.01">
        </div>

        <div class="form-group">
          <label for="pesoMax">Peso massimo (g)</label>
          <input id="pesoMax" type="number" step="0.01">
        </div>

        <div class="form-group">
          <label for="classeGioco">Gioco radiale - Classe</label>
          <select id="classeGioco">
            <option value="">â€”</option>
            <option value="C2">C2</option>
            <option value="CN">CN</option>
            <option value="C3">C3</option>
            <option value="C4">C4</option>
            <option value="C5">C5</option>
          </select>
        </div>

        <div class="form-group">
          <label for="giocoMin">Gioco min (Âµm)</label>
          <input id="giocoMin" type="number" step="0.1">
        </div>

        <div class="form-group">
          <label for="giocoMax">Gioco max (Âµm)</label>
          <input id="giocoMax" type="number" step="0.1">
        </div>

        <!-- CARICAMENTO IMMAGINI -->
        <div class="form-group full-width">
          <label>Carica disegno tecnico</label>

          <!-- Galleria -->
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('file-galleria').click()">
            ğŸ“ Scegli dalla galleria
          </button>
          <input type="file" id="file-galleria" accept="image/*" style="display:none">

          <!-- Fotocamera -->
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('file-camera').click()">
            ğŸ“¸ Scatta foto
          </button>
          <input type="file" id="file-camera" accept="image/*" capture="environment" style="display:none">

          <input id="disegnoUrl" type="url" placeholder="URL immagine (opzionale)">
        </div>

        <div class="form-actions full-width">
          <button type="submit" class="btn btn-primary">ğŸ’¾ Salva</button>
          <button type="button" id="btn-reset" class="btn btn-secondary">ğŸ§¹ Svuota</button>
          <button type="button" id="btn-elimina" class="btn btn-danger" disabled>ğŸ—‘ï¸ Elimina</button>
        </div>

      </form>

      <!-- PREVIEW IMMAGINE -->
      <div class="drawing-container full-width">
        <h3>Disegno tecnico</h3>
        <div id="drawing-placeholder" class="drawing-placeholder">Nessun disegno caricato</div>
        <img id="drawing-image" class="drawing-image" src="">
      </div>

    </section>
  </main>

  <footer class="app-footer">
    <small>App locale Â· GitHub Pages</small>
  </footer>

  <!-- ====================== -->
  <!-- MODALE SCHEDA TECNICA -->
  <!-- ====================== -->
  <div id="scheda-modal" class="modal hidden">
    <div class="modal-backdrop"></div>

    <div class="modal-content">
      <div class="modal-header">
        <h3 id="scheda-codice"></h3>
        <button id="scheda-close" class="modal-close">âœ–</button>
      </div>

      <div class="modal-body">
        <p id="scheda-sub" class="scheda-sub"></p>

        <div class="scheda-grid">
          <div><strong>IR:</strong> <span id="scheda-ir"></span></div>
          <div><strong>OR:</strong> <span id="scheda-or"></span></div>
          <div><strong>Foro IR:</strong> <span id="scheda-ir-diametro"></span></div>
          <div><strong>Sfere:</strong> <span id="scheda-sfere"></span></div>
          <div><strong>Gabbia:</strong> <span id="scheda-gabbia"></span></div>
          <div><strong>Grasso:</strong> <span id="scheda-grasso"></span></div>
          <div><strong>Schermo:</strong> <span id="scheda-schermo"></span></div>
          <div><strong>Peso:</strong> <span id="scheda-peso"></span></div>
          <div><strong>Gioco:</strong> <span id="scheda-gioco"></span></div>
        </div>

        <div class="scheda-disegno">
          <div id="scheda-drawing-placeholder" class="drawing-placeholder">Nessuna immagine</div>
          <img id="scheda-drawing-image" class="drawing-image" src="">
        </div>

      </div>

    </div>
  </div>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- JSZip -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <!-- Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js");
    }
  </script>

  <script src="script.js"></script>

</body>
</html>
